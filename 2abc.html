<!DOCTYPE html>
<html>

<head>
    <title>TV FLUX</title>
    <!-- Compiled and minified CSS -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/materialize/1.0.0/css/materialize.min.css">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1,user-scalable=0" />
    <!-- Compiled and minified JavaScript -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.1.0/jquery.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/materialize/0.98.0/js/materialize.min.js"></script>
    <link rel="stylesheet" href="main.css">
    <script type="module" src="https://unpkg.com/x-frame-bypass"></script>
 
    <link rel="stylesheet" href="vivify.min.css">
</head>

<body class="vivify fadeIn delay-2000" onload="player.play();">

    <script src="https://cdn.jsdelivr.net/hls.js/latest/hls.min.js"></script>
    <video id="video" src="https://peer3.ustv.to/ABC/myStream/playlist.m3u8?wmsAuthSign=c2VydmVyX3RpbWU9MTIvMTMvMjAxOSA5OjI0OjE0IFBNJmhhc2hfdmFsdWU9ZU1vaDdIcmtneXlKMlZDVUZGUE1ndz09JnZhbGlkbWludXRlcz0zNjAmc3RybV9sZW49MA=="></video>
<div id="metadata">
<div id="title">Title</div>
<div id="description">Lorem ipsum dolor sit amet, consectetur adipiscing elit. Proin commodo tristique laoreet. Cras id erat accumsan, tincidunt diam tristique, gravida.</div>
</div>
<div id="controls">
    <div id="play_pause">
        <div class="button" id="pause">&#xf04c;</div>
        <div class="button" id="play">&#xf04b;</div>
    </div>
    <div class="time" id="elapsed">00:00</div>
    <div class="time" id="separator"> / </div>
    <div class="time" id="duration">00:00</div>
  <div class="slider seek"><input type="range" id="seek" value="0" min="0" max="100"></div>
    <div class="speaker">
        <div class="button" id="unmuted">&#xf028;</div>
        <div class="button" id="muted">&#xf026;</div>
    </div>
    <div class="slider"><input type="range" id="volume" min="0" max="1" step="0.1" value="1"></div>
</div>
<script>
var toHHMMSS = function (value) {
  var sec_num = parseInt(value, 10); // don't forget the second param
  var hoursInt = Math.floor(sec_num / 3600);
  var minutes = Math.floor((sec_num - (hoursInt * 3600)) / 60);
  var seconds = sec_num - (hoursInt * 3600) - (minutes * 60);
  var hours;

  if (hoursInt < 10) { hours = "0" + hoursInt + ":"; }
  if (hoursInt < 1) { hours = ""; }
  if (minutes < 10) { minutes = "0" + minutes; }
  if (seconds < 10) { seconds = "0" + seconds; }
  var time = hours + minutes + ':' + seconds;
  return time;
};
var videoDimensions = function(video) {
  // Ratio of the video's intrisic dimensions
  var videoRatio = video.videoWidth / video.videoHeight;
  // The width and height of the video element
  var width = video.offsetWidth, height = video.offsetHeight;
  // The ratio of the element's width to its height
  var elementRatio = width/height;
  // If the video element is short and wide
  if(elementRatio > videoRatio) width = height * videoRatio;
  // It must be tall and thin, or exactly equal to the original ratio
  else height = width / videoRatio;
  return {
    width: width,
    height: height
  };
};
var resizeOverlays = function() {
  if(video.videoWidth == 0 || video.videoHeight == 0) {
      return;
    }
  var dimensions = videoDimensions(video);
  var frameWidth = dimensions.width;
  var widthCss = "width: " + frameWidth + "px;";
  var left = (video.offsetWidth - frameWidth) / 2;
  var leftCss = "left: " + left + "px;";
  var bottom = (video.offsetHeight - dimensions.height) / 2;
  var bottomCss = "bottom: " + bottom + "px;";
  metadata.style = widthCss + leftCss;
  controls.style = widthCss + leftCss + bottomCss;
};
if(Hls.isSupported()) {
  var controls = document.getElementById('controls');
  var metadata = document.getElementById('metadata');
  var video = document.getElementById('video');
  var play = document.getElementById('play');
  var pause = document.getElementById('pause');
  var elapsed = document.getElementById('elapsed');
  var separator = document.getElementById('separator');
  var duration = document.getElementById('duration');
  var seek = document.getElementById('seek');
  var muted = document.getElementById('muted');
  var unmuted = document.getElementById('unmuted');
  var volume = document.getElementById('volume');
  var hideOverlaysTimer = undefined;
  var setHideOverlaysTimer = function() { 
    hideOverlaysTimer = window.setTimeout(function() {
      if(video.paused) {
        return;
      }
      document.body.className = 'hideOverlays';
    }, 5000);
  };
  var clearHideOverlaysTimer = function() {
    if(typeof hideOverlaysTimer === 'number') {
      window.clearTimeout(hideOverlaysTimer);
      hideOverlaysTimer = undefined;
    }
  };
  var hls = new Hls();
  hls.loadSource(video.src);
  hls.attachMedia(video);
  document.body.addEventListener('mousemove', function(e) {
    document.body.className = '';
    clearHideOverlaysTimer();
    setHideOverlaysTimer();
  });
  play.addEventListener('click', function(e) {
    video.play();
  });
  pause.addEventListener('click', function(e) {
    video.pause();
    document.body.class = '';
  });
  window.addEventListener('resize', function(e) {
    resizeOverlays();
  });
  video.addEventListener('loadeddata', function(e) {
    resizeOverlays();
    video.play();
  });
  video.addEventListener('play', function(e) {
    play.style = "display: none;";
    pause.style = "display: block;";
    setHideOverlaysTimer();
  });
  video.addEventListener('pause', function(e) {
    play.style = "display: block;";
    pause.style = "display: none;";
    document.body.className = '';
  });
  video.addEventListener('durationchange', function(e) {
    duration.innerHTML = toHHMMSS(video.duration);
    seek.max = video.duration;
  });
  video.addEventListener('timeupdate', function(e) {
    elapsed.innerHTML = toHHMMSS(video.currentTime);
    seek.value = video.currentTime;
  });
  video.addEventListener('click', function(e) {
    if(video.paused) {
      video.play();
    }
    else {
      video.pause();
    }
  });
  video.addEventListener('ended', function(e) {
  });
  volume.addEventListener('change', function(e) {
    video.volume = volume.value;
  });
  unmuted.addEventListener('click', function(e) {
    video.muted = true;
    unmuted.style = "display: none;";
    muted.style = "display: block;";
    volume.disabled = true;
  });
  muted.addEventListener('click', function(e) {
    video.muted = false;
    muted.style = "display: none;";
    unmuted.style = "display: block;";
    volume.disabled = false;
  });
  seek.addEventListener('change', function(e) {
    video.currentTime = seek.value;
  });
}
</script>
 <script>
 var player = videojs('hls-example');
 player.play();
 </script>
</body>

</html>